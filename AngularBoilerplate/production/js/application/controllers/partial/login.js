define(["angular","utils/cookie"],function(e,t){return["$scope","AuthServiceProvider","$rootScope",function(e,n,r){e.showEnter=!0,e.showForgot=!1,e.authenticate=function(){e.validatePassword(e.user.pass)?n.authenticate({user:e.user.name,pass:e.user.pass}).success(function(n){console.log("response",n),n.authToken&&n.StatusCode===200?(t.remove("TA-authToken"),e.user.remember&&t.set("TA-authToken",n.authToken,{maxAge:6e3}),r.$broadcast("event:auth-loginConfirmed",n),e.showLogin=!1):(e.showLogin=!0,e.error=n.StatusMessage),n.StatusCode===403&&r.$broadcast("event:auth-loginRefused",n)}).error(function(){e.error="Request error"}):e.error="Invalid password"},e.validatePassword=function(e){var t=/^(?=.*\d)(?=.*[A-Z]).{8,32}$/;return t.test(e)&&e.length>=8&&e.length<=32?!0:!1},e.resetRequest=function(){n.resetRequest({user:e.user.name}).success(function(t,n){n===200&&(e.showLogin=!1),e.error=t.StatusMessage}).error(function(){e.error="Request error"})},e.resetAction=function(){n.resetAction({user:e.user.name}).success(function(t,n){n==="200"&&(e.showLogin=!1),n==="400",n==="501",n==="502",e.error=t.StatusMessage}).error(function(){e.error="Request error"})},e.changeState=function(){e.showEnter=e.showEnter?!1:!0,e.showForgot=e.showForgot?!1:!0},!r.authenticated&&!t.get("TA-authToken")&&(e.showLogin=!0),e.$apply()}]});