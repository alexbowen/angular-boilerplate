define(["utils/cookie"],function(e){return["$scope","AuthServiceProvider","$rootScope",function(t,n,r){t.showEnter=!0,t.showForgot=!1,t.authenticate=function(){t.validatePassword(t.user.pass)?n.authenticate({user:t.user.name,pass:t.user.pass}).success(function(n){console.log("response",n),n.authToken&&n.StatusCode===200?(e.remove("TA-authToken"),t.user.remember&&e.set("TA-authToken",n.authToken,{maxAge:6e3}),r.$broadcast("event:auth-loginConfirmed",n),t.showLogin=!1):(t.showLogin=!0,t.error=n.StatusMessage),n.StatusCode===403&&r.$broadcast("event:auth-loginRefused",n)}).error(function(){t.error="Request error"}):t.error="Invalid password"},t.validatePassword=function(e){var t=/^(?=.*\d)(?=.*[A-Z]).{8,32}$/;return t.test(e)&&e.length>=8&&e.length<=32?!0:!1},t.resetRequest=function(){n.resetRequest({user:t.user.name}).success(function(e,n){n===200&&(t.showLogin=!1),t.error=e.StatusMessage}).error(function(){t.error="Request error"})},t.resetAction=function(){n.resetAction({user:t.user.name}).success(function(e,n){n==="200"&&(t.showLogin=!1),n==="400",n==="501",n==="502",t.error=e.StatusMessage}).error(function(){t.error="Request error"})},t.changeState=function(){t.showEnter=t.showEnter?!1:!0,t.showForgot=t.showForgot?!1:!0},!r.authenticated&&!e.get("TA-authToken")&&(t.showLogin=!0),t.$apply()}]});